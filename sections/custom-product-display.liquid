{% schema %}
{
  "name": "Custom Product Display",
  "settings": [
    {
      "type": "product",
      "id": "selected_product",
      "label": "Select Product"
    }
  ],
  "presets": [
    {
      "name": "Custom Product Display"
    }
  ]
}
{% endschema %}

{% if section.settings.selected_product %}
  {% assign product = all_products[section.settings.selected_product] %}

  <!-- Product JSON for Globo to handle swatch functionality -->
  <script type="application/json" id="ProductJson-{{ section.id }}">
    {{ product | json }}
  </script>

  <div class="custom-product-display" style="text-align: center; padding: 30px;">
    <!-- Product Image -->
    <div class="product-image" style="margin-bottom: 20px;">
      <img 
        src="{{ product.featured_image | img_url: 'large' }}" 
        alt="{{ product.title }}" 
        id="MainImage-{{ section.id }}"
        style="max-width: 250px; margin: 0 auto;"
      />
    </div>

    <!-- Product Name -->
    <h3 style="margin-bottom: 5px;">{{ product.title }}</h3>

    <!-- Product Price -->
    <p style="font-size: 18px; font-weight: 500; margin-bottom: 15px;">{{ product.price | money }}</p>

    <!-- Globo Color Swatch -->
    <div class="gcs-product" data-product-handle="{{ product.handle }}"></div>
  </div>

  <!-- JS: Re-initialize Globo Color Swatches -->
  <script>
    setTimeout(function() {
      if (typeof GCS !== 'undefined' && typeof GCS.init === 'function') {
        GCS.init();
      } else {
        console.warn('Globo GCS is not available.');
      }
    }, 1000);
  </script>

{% else %}
  <p style="text-align:center;">No product selected.</p>
{% endif %}
